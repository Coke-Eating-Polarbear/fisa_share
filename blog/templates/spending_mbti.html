{% load static %}
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì†Œë¹„ ì„±í–¥ ë° ì†Œë¹„ ì˜ˆì¸¡</title>
    <link rel="stylesheet" href="{% static 'css/spending_mbti.css' %}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
    </style>
</head>
<body>
    {% csrf_token %}
    <header>
        <div class="navbar">
            <!-- ë¡œê³  -->
            <div class="logo">
                <a href="{% url 'loginmain' %}">
                    <img src="{% static 'img/header_logo.png' %}" alt="ë¡œê³ ">
                </a>
            </div>
            <!-- ë„¤ë¹„ê²Œì´ì…˜ -->
            <div class="nav-links">
                <a href="{% url 'originreport' %}">ë‚´ ê¸ˆìœµ ë°”ë¡œë³´ê¸°</a>
                <div class="dropdown">
                    <a href="#">ë‚´ ì˜ˆ/ì ê¸ˆ ì°¾ê¸°</a>
                    <div class="dropdown-content">
                        <a href="{% url 'top5' %}">ì‹ ê·œìƒí’ˆì¶”ì²œ</a>
                        <a href="{% url 'better' %}">ê¸°ì¡´ìƒí’ˆë¹„êµ</a>
                    </div>
                </div>
                <a href="{% url 'spending_mbti' %}">ìŠ¬ê¸°ë¡œìš´ ì†Œë¹„ìƒí™œ</a>
            </div>
            <!-- íšŒì› ì •ë³´ ë° ë§ˆì´í˜ì´ì§€ -->
            <div class="user-info">
                <span>{{ user_name }}ë‹˜</span>
                <a href="./mypage">ë§ˆì´í˜ì´ì§€</a>
                <form method="POST" action="{% url 'logout' %}">
                    {% csrf_token %}
                    <button name="logout">ë¡œê·¸ì•„ì›ƒ</button>
                </form>
            </div>
        </div>
    </header>
</body>
</html>


<!-- ë©”ì¸ ì½˜í…ì¸  -->
<div class="container" style="display: flex; flex-direction: column; gap: 2rem;">
    
    <!-- í° ë°•ìŠ¤ -->
    <div class="box" style="border: 1px solid #ccc; border-radius: 10px; padding: 1.5rem; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);">
        
        <!-- ì œëª©ê³¼ ë“œë¡­ë‹¤ìš´ -->
        <div class="title-and-selector" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
            <h2 style="margin: 0; margin-left: 1rem;">ì§€ì¶œ ë¹ˆë„/ê¸ˆì•¡ë³„ ì†Œë¹„</h2>
            <div class="date-selector" style="text-align: right;">
                <label for="dateRangeSelect" style="font-size: 1rem; font-weight: bold; margin-right: 1rem;">ê¸°ê°„ ì„ íƒ:</label>
                <select id="dateRangeSelect" onchange="filterData(this.value)" style="padding: 0.5rem; font-size: 1rem;">
                    <option value="1m">ì§ì „ 1ë‹¬</option>
                    <option value="6m">ìµœê·¼ 6ë‹¬</option>
                    <option value="1y">ìµœê·¼ 1ë…„</option>
                </select>                
            </div>
        </div>

        <!-- ê·¸ë˜í”„ ì„¹ì…˜ -->
        <div class="charts-section" style="display: flex; justify-content: space-between; align-items: flex-start; gap: 2rem;">
            
            <!-- ì§€ì¶œ ë¹ˆë„ë³„ ì†Œë¹„ -->
            <div class="chart-container" style="flex: 1; border: 1px solid #ccc; border-radius: 10px; padding: 1.5rem; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);">
                <div class="chart-header">
                    <div class="chart-title" style="text-align: center;">ì§€ì¶œ ë¹ˆë„ë³„ ì†Œë¹„</div>
                </div>
                <canvas id="frequencyChart" class="chart"></canvas>
            </div>

            <!-- ì§€ì¶œ ê¸ˆì•¡ë³„ ì†Œë¹„ -->
            <div class="chart-container" style="flex: 1; border: 1px solid #ccc; border-radius: 10px; padding: 1.5rem; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);">
                <div class="chart-header">
                    <div class="chart-title" style="text-align: center;">ì§€ì¶œ ê¸ˆì•¡ë³„ ì†Œë¹„</div>
                </div>
                <canvas id="amountChart" class="chart"></canvas>
            </div>
        </div>
    </div>

<!-- 2. ì†Œë¹„ ì˜ˆì¸¡ ë° ì¹´ë“œ ì¶”ì²œ ë°•ìŠ¤ -->
<div class="box" style="border: 1px solid #ccc; border-radius: 10px; padding: 1rem; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);">
    <h2 style="margin-top: 15px; margin-bottom: 20px; text-align: center; line-height: 0.5;">ì†Œë¹„ ì˜ˆì¸¡ ë° ì¹´ë“œ ì¶”ì²œ</h2>
    <div class="prediction-and-cards-section" style="display: flex; gap: 2rem; align-items: flex-start; margin-top: 0.5rem;">
        <!-- ì†Œë¹„ ì˜ˆì¸¡ ì„¹ì…˜ -->
        <div class="prediction-section" style="flex: 0.7; margin-top: 10px;"> <!-- ì˜ˆì¸¡ ì„¹ì…˜ ê°„ê²© ì„¤ì • -->
            <div class="chart-container" style="margin-bottom: 1rem;">
                <div class="chart-header">
                    <div class="chart-title">ë‹¤ìŒ ë‹¬ ì†Œë¹„ ì˜ˆì¸¡</div>
                    <div class="filter-section" style="justify-content: flex-end;">
                        <label for="categorySelect">í•­ëª© ì„ íƒ:</label>
                        <select id="categorySelect" onchange="updatePredictionChart()" style="padding: 0.3rem;">
                            <option value="predicted_total">ì´í•©</option>
                            <option value="eat">ì‹ë¹„</option>
                            <option value="transfer">êµí†µë¹„</option>
                            <option value="utility_amount">ê³µê³¼ê¸ˆ</option>
                            <option value="phone">í†µì‹ ë¹„</option>
                            <option value="home">ì£¼ê±°ë¹„</option>
                            <option value="hobby">ì—¬ê°€/ì·¨ë¯¸</option>
                            <option value="fashion">íŒ¨ì…˜/ì¡í™”</option>
                            <option value="party">ëª¨ì„íšŒë¹„</option>
                            <option value="allowance">ê²½ì¡°ì‚¬</option>
                            <option value="study">êµìœ¡ë¹„</option>
                            <option value="medical">ì˜ë£Œë¹„</option>
                        </select>
                    </div>
                </div>
                <canvas id="predictionLineChart" class="chart" style="width: 100%; height: 250px;"></canvas>
            </div>
            <!-- ì„¤ëª… -->
            <div class="description" style=" line-height: 1; font-size: 1rem; color: #555;">
                <p>ë‹¤ìŒ ë‹¬ ì˜ˆìƒ ì†Œë¹„ ê¸ˆì•¡ì€ <span id="predicted-total" class="highlight"></span>ì› ì…ë‹ˆë‹¤.</p>
                <p>ğŸ’¡<span style="font-weight: bold; color: blue;"> {{top_card_list.0}}</span>ì™€ <span style="font-weight: bold; color: blue;"> {{top_card_list.1}}</span>ì—ì„œ ê°€ì¥ í° ì†Œë¹„ê°€ ì˜ˆìƒë©ë‹ˆë‹¤.</p>
                <p>ì†Œë¹„ê°€ ë†’ì€ í•­ëª©ì—ì„œ <span style="font-weight: bold; color: red;">í˜œíƒì´ ë†’ì€ ì¹´ë“œ</span>ë¥¼ ì¶”ì²œë“œë ¤ìš”!</p>
                <!-- <p>ğŸ’³ì˜ˆìƒ ì ˆê° ê¸ˆì•¡: <span class="highlight">##ì›ğŸ’³</span></p> -->
                <p>ì¹´ë“œ ì´ë¯¸ì§€ë¥¼ í´ë¦­í•´ì„œ ì •ë³´ë¥¼ í™•ì¸í•´ë³´ì„¸ìš” ğŸ˜Š</p>
            </div>
        </div>

        <!-- ì¹´ë“œ ì¶”ì²œ ë°•ìŠ¤ -->
        <div id="card-container" style="flex: 1; display: flex; flex-direction: column; gap: 0.5rem; margin-right: 20px; margin-top: 10px">
            {% for key, card_list in card_detail_results.items %}
                {% for card in card_list %}
                    <div class="card-box" style="border: 1px solid #ccc; padding: 0.5rem; border-radius: 5px;">
                        <a href="{{ card.Link }}" target="_blank" class="card-image-box" style="display: flex; align-items: center; gap: 1rem;">
                            <img src="{{ card.image }}" alt="{{ card.Name }} ì´ë¯¸ì§€">
                        </a>
                        <div class="card-description-box" style="margin-top: 0.5rem; display: flex; flex-direction: column; gap: 0.3rem;">
                            <div class="card-name">{{ card.corp }} - {{ card.Name }}</div>
                            <div class="card-description">
                                <p>{{key}} ì¹´í…Œê³ ë¦¬ì˜ í˜œíƒì´ ê°€ì¥ ë†’ì€ ì¹´ë“œì…ë‹ˆë‹¤</p>
                                <p>{{user_name}}ë‹˜ì˜ ì†Œë¹„ ì„±í–¥ì„ ë°”íƒ•ìœ¼ë¡œ ë‹¤ìŒ ë‹¬ ì†Œë¹„ë¥¼ ì˜ˆì¸¡í–ˆì„ ë•Œ</p>
                                <p>ì´ {{card.AmountNum}}ì›ì˜ {{card.max_value}}%ì¸ {{card.discount}}ì›ì„ í• ì¸ ë°›ì„ ìˆ˜ ìˆì–´ìš”-!</p>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            {% endfor %}
        </div>
    </div>
</div>

    

                <!-- ì„¤ëª… ì„¹ì…˜ -->
                <!-- <div class="content-container">
                    <p>{{ user_name }}ë‹˜ì€ ì „ì²´ì ìœ¼ë¡œ <span class="highlight">1. ì‹ë¹„</span> 2. ì‡¼í•‘ì—ì„œ ê°€ì¥ ì†Œë¹„ê°€ ë§ì€ í–‰ë³µì¶”êµ¬í˜•~!!</p>
                    <p>ì‹ë¹„ ë¶„ì•¼ê°€ ê°€ì¥ ë§ì€ ë¹ˆë„ë¡œ ì‚¬ìš©</p>
                    <p>ì‡¼í•‘ ë¶„ì•¼ê°€ ê°€ì¥ í° ê¸ˆì•¡ ê²°ì œ...?</p>
                    <p>ë‹¤ìŒ ë‹¬ ì˜ˆìƒ ì†Œë¹„ ê¸ˆì•¡ì€ <span class="highlight">##ì›</span> ì…ë‹ˆë‹¤~</p>
                    <br>
                    <p>{{ user_name }}ë‹˜, <span class="highlight">##</span> ë¶„ì•¼ì˜ í˜œíƒì´ í° ì¹´ë“œë¥¼ ì‚¬ìš©í•˜ë©´ ì†Œë¹„ë¥¼ ì¤„ì¼ ìˆ˜ ìˆë‹¤~</p>
                    <p>â‡’ ì´ê±´ ë’¤ì— ë³´ì—¬ì¤„ ì¹´ë“œ ì¤‘ í•´ë‹¹ ë¶„ì•¼ í˜œíƒì´ ê°€ì¥ í° ì¹´ë“œ ê¸°ì¤€ìœ¼ë¡œ ê³„ì‚°í•´ì„œ ë³´ì—¬ì£¼ê¸°</p>
                </div> -->
            </div>
        </div>

        <script>
            // Djangoì—ì„œ ì „ë‹¬ëœ JSON ë°ì´í„°ë¥¼ JavaScript ê°ì²´ë¡œ ë³€í™˜
            const nextMonthPrediction = JSON.parse('{{ next_month_prediction_json|safe }}');
        
            // predicted_total ê°’ì„ HTMLì— ì‚½ì…
            const predictedTotal = nextMonthPrediction.predicted_total;
        
            // ì‹­ì› ë‹¨ìœ„ë¡œ ë°˜ì˜¬ë¦¼
            const roundedPredictedTotal = Math.round(predictedTotal / 10) * 10;
        
            // ìˆ«ìë¥¼ 3ìë¦¬ë§ˆë‹¤ ì‰¼í‘œë¡œ í¬ë§·
            const formattedPredictedTotal = roundedPredictedTotal.toLocaleString('ko-KR');
        
            // HTML ì—…ë°ì´íŠ¸
            document.getElementById('predicted-total').textContent = formattedPredictedTotal;
        
            
            // ë°ì´í„° ë°›ì•„ì™€ì•¼í•¨.
            const FreqsortedCategories = JSON.parse('{{ Freq_sorted_categories_json|escapejs }}');
            const freqTotal = JSON.parse('{{ Freq_total_json|escapejs }}');
        
            //  ì¹´í…Œê³ ë¦¬ë³„ ê³ ìœ  ìƒ‰ìƒ ì •ì˜ (ë¬´ì§€ê°œ ìˆœì„œ íŒŒìŠ¤í…”í†¤)
            // const categoryColors = {
            //     'ì‹ë¹„': '#FFB3BA',       // ì—°í•œ ë¹¨ê°•
            //     'êµí†µë¹„': '#FFDFBA',    // ì—°í•œ ì£¼í™©
            //     'ëª¨ì„íšŒë¹„': '#BAFFC9',  // ì—°í•œ ì—°ì´ˆë¡
            //     'êµìœ¡ë¹„': '#CAFFBF',    // ì—°í•œ ì´ˆë¡
            //     'ì£¼ê±°ë¹„': '#BAE1FF',    // ì—°í•œ í•˜ëŠ˜ìƒ‰
            //     'í†µì‹ ë¹„': '#A0C4FF',    // ì—°í•œ íŒŒë‘
            //     'íŒ¨ì…˜/ì¡í™”': '#BDB2FF', // ì—°í•œ ë³´ë¼
            //     'ì˜ë£Œë¹„': '#FFC6FF',    // ì—°í•œ í•‘í¬
            //     'ì—¬ê°€/ì·¨ë¯¸': '#FFB4E6', // ì—°í•œ í•‘í¬ í¼í”Œ
            //     'ê²½ì¡°ì‚¬': '#c8babe',    // ì—°í•œ ë¯¼íŠ¸
            //     'ê³µê³¼ê¸ˆ': '#FFFFFC',    // ì—°í•œ í¬ë¦¼
            // };

            const categoryColors = {
            'ì‹ë¹„': '#FF6F61',       // ì„ ëª…í•œ ë¹¨ê°•
            'êµí†µë¹„': '#FFAA00',    // ì„ ëª…í•œ ì£¼í™©
            'ëª¨ì„íšŒë¹„': '#56C596',  // ì„ ëª…í•œ ì´ˆë¡
            'êµìœ¡ë¹„': '#1EAC91',    // ì„ ëª…í•œ ì´ˆë¡
            'ì£¼ê±°ë¹„': '#4A90E2',    // ì„ ëª…í•œ í•˜ëŠ˜ìƒ‰
            'í†µì‹ ë¹„': '#0073E6',    // ì„ ëª…í•œ íŒŒë‘
            'íŒ¨ì…˜/ì¡í™”': '#7D3EB5', // ì„ ëª…í•œ ë³´ë¼
            'ì˜ë£Œë¹„': '#E83E8C',    // ì„ ëª…í•œ í•‘í¬
            'ì—¬ê°€/ì·¨ë¯¸': '#F368E0', // ì„ ëª…í•œ í•‘í¬ í¼í”Œ
            'ê²½ì¡°ì‚¬': '#2F4F4F',    // ë‹¤í¬ ë¯¼íŠ¸
            'ê³µê³¼ê¸ˆ': '#FFD700',    // ì„ ëª…í•œ ë…¸ë‘
        };

        
        
        
            // `frequencyData` ìƒì„±
            const freq_labels = Object.keys(FreqsortedCategories); // í‚¤ë¥¼ ë¼ë²¨ë¡œ ì‚¬ìš©
            const freq_data = Object.values(FreqsortedCategories); // ê°’ì„ ë°ì´í„°ë¡œ ì‚¬ìš©
            const freq_backgroundColors = freq_labels.map(label => categoryColors[label] || '#DDDDDD'); // ê¸°ë³¸ ìƒ‰ìƒì€ íšŒìƒ‰
        
            const frequencyData = {
                labels: freq_labels,
                datasets: [{
                    data: freq_data,
                    backgroundColor: freq_backgroundColors, // ì¹´í…Œê³ ë¦¬ë³„ ìƒ‰ìƒ ì ìš©
                }]
            };
        
            // `amountData` ìƒì„±
            const sortedCategories = JSON.parse('{{ sorted_categories_json|escapejs }}');
            const amountTotal = JSON.parse('{{ amount_total_json|escapejs }}');
        
            const amount_labels = Object.keys(sortedCategories); // í‚¤ë¥¼ ë¼ë²¨ë¡œ ì‚¬ìš©
            const amount_data = Object.values(sortedCategories); // ê°’ì„ ë°ì´í„°ë¡œ ì‚¬ìš©
            const amount_backgroundColors = amount_labels.map(label => categoryColors[label] || '#DDDDDD'); // ê¸°ë³¸ ìƒ‰ìƒì€ íšŒìƒ‰
        
            const amount_top1 = amount_labels[0];
            const amount_top2 = amount_labels[1];
            const amount_top3 = amount_labels[2];



            const amountData = {
                labels: amount_labels,
                datasets: [{
                    data: amount_data,
                    backgroundColor: amount_backgroundColors, // ì¹´í…Œê³ ë¦¬ë³„ ìƒ‰ìƒ ì ìš©
                }]
            };
        
            // ì°¨íŠ¸ ìƒì„±
            new Chart(document.getElementById('frequencyChart'), {
                type: 'pie',
                data: {
                    labels: frequencyData.labels,
                    datasets: [{
                        data: frequencyData.datasets[0].data,
                        backgroundColor: freq_backgroundColors,
                        offset: function(ctx) {
                            return ctx.dataIndex === 0 || ctx.dataIndex === 1 ? 20 : 0; // ì²« ë²ˆì§¸ì™€ ë‘ ë²ˆì§¸ í•­ëª©ë§Œ 20px íŠ€ì–´ë‚˜ì˜¤ê²Œ
                        }
                    }]
                },
                options: { 
                    responsive: true,
                    maintainAspectRatio: false,
                    aspectRatio: 1.5,
                    plugins: {
                        legend: {
                            display: true, // ë²”ë¡€ í‘œì‹œ
                            position: 'right', // ë²”ë¡€ ìœ„ì¹˜
                            labels: {
                                filter: function(legendItem, data) {
                                    return legendItem.index < 5; // Top 5 í•­ëª©ë§Œ í‘œì‹œ
                                }
                            }
                        }
                    }
                }
            });
        
            // Amount Chart
            new Chart(document.getElementById('amountChart'), {
                type: 'pie',
                data: {
                    labels: amountData.labels,
                    datasets: [{
                        data: amountData.datasets[0].data,
                        backgroundColor: amount_backgroundColors,
                        offset: function(ctx) {
                            return ctx.dataIndex === 0 || ctx.dataIndex === 1 ? 20 : 0; // ì²« ë²ˆì§¸ì™€ ë‘ ë²ˆì§¸ í•­ëª©ë§Œ 20px íŠ€ì–´ë‚˜ì˜¤ê²Œ
                        }
                    }]
                },
                options: { 
                    responsive: true,
                    maintainAspectRatio: false,
                    aspectRatio: 1.5,
                    plugins: {
                        legend: {
                            display: true, // ë²”ë¡€ í‘œì‹œ
                            position: 'right', // ë²”ë¡€ ìœ„ì¹˜
                            labels: {
                                filter: function(legendItem, data) {
                                    return legendItem.index < 5; // Top 5 í•­ëª©ë§Œ í‘œì‹œ
                                }
                            }
                        }
                    }
                }
            });
        
        
        
            const predictionLineData = {
                labels: ['9ì›”', '10ì›”', '11ì›”', '12ì›”'], // ì›”ë³„ ë ˆì´ë¸”
                datasets: [
                    {
                        label: 'ì›”ë³„ ì†Œë¹„ ì´í•©', // ë°ì´í„°ì…‹ ì´ë¦„
                        data: [1200000, 1350000, 1280000, 1400000], // ê° ì›”ë³„ ì†Œë¹„ ì´í•© ë°ì´í„°
                        borderColor: '#36a2eb',
                        backgroundColor: 'rgba(54, 162, 235, 0.2)',
                        fill: false, // êº¾ì€ì„  ì•„ë˜ ì±„ìš°ê¸°
                    },
                ],
            };
            

        
            // í•„í„°ë§ ë°ì´í„° í•¨ìˆ˜
            function filterData(period) {
                // í˜„ì¬ URL ê°€ì ¸ì˜¤ê¸°
                const url = new URL(window.location.href);

                // ì¿¼ë¦¬ ë§¤ê°œë³€ìˆ˜ ì„¤ì •
                url.searchParams.set('period', period);

                // í˜ì´ì§€ ë¦¬ë¡œë“œ
                window.location.href = url.toString();
            }

            // í˜ì´ì§€ ë¡œë“œ ì‹œ `select` ë°•ìŠ¤ ì´ˆê¸°í™”
            window.addEventListener('load', function () {
                const urlParams = new URLSearchParams(window.location.search);
                const selectedPeriod = urlParams.get('period'); // URLì—ì„œ `period` íŒŒë¼ë¯¸í„° ê°’ ê°€ì ¸ì˜¤ê¸°

                if (selectedPeriod) {
                    // `select` ë°•ìŠ¤ ê°’ ì„¤ì •
                    document.getElementById('dateRangeSelect').value = selectedPeriod;
                }
            });
            
        //     function filterData(period) {
        //     let startDate;

        //     // í˜„ì¬ ë‚ ì§œ ê¸°ì¤€ìœ¼ë¡œ ê¸°ê°„ ê³„ì‚°
        //     const today = new Date();

        //     if (period === '1m') {
        //         startDate = new Date(today.setMonth(today.getMonth() - 1)); // ì§ì „ 1ë‹¬
        //     } else if (period === '6m') {
        //         startDate = new Date(today.setMonth(today.getMonth() - 6)); // ìµœê·¼ 6ë‹¬
        //     } else if (period === '1y') {
        //         startDate = new Date(today.setFullYear(today.getFullYear() - 1)); // ìµœê·¼ 1ë…„
        //     }

        //     console.log('Start Date:', startDate.toISOString().split('T')[0]); // YYYY-MM-DD ì¶œë ¥

        //     // URLì— `period` íŒŒë¼ë¯¸í„° ì¶”ê°€
        //     const url = new URL(window.location.href);
        //     url.searchParams.set('period', period); // `period` ê°’ì„ ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ë¡œ ì„¤ì •

        //     // í˜ì´ì§€ë¥¼ ë¦¬ë¡œë“œ
        //     window.location.href = url.toString();
        // }

        
        
            //ë‹¤ìŒ ë‹¬ ì˜ˆì¸¡ ì†Œë¹„
            // ì›”ë³„ ì†Œë¹„ ë°ì´í„°
            const month1 = JSON.parse('{{ month1_json|escapejs }}');
            const month2 = JSON.parse('{{ month2_json|escapejs }}');
            const month3 = JSON.parse('{{ month3_json|escapejs }}');
            
            // ì°¨íŠ¸ ê°ì²´ ì €ì¥ ë³€ìˆ˜
            let predictionChart;
        
            // êº¾ì€ì„  ê·¸ë˜í”„ ìƒì„±/ì—…ë°ì´íŠ¸ í•¨ìˆ˜
            function renderPredictionChart(data, category) {
                const ctx = document.getElementById('predictionLineChart').getContext('2d');
        
                // ê¸°ì¡´ ì°¨íŠ¸ê°€ ìˆìœ¼ë©´ ì‚­ì œ
                if (predictionChart) {
                    predictionChart.destroy();
                }
                const months = JSON.parse('{{ months_json|escapejs }}');  // Django ë°ì´í„° JSë¡œ ì „ë‹¬
                console.log(months);  // JavaScriptì—ì„œ ë°ì´í„° ì¶œë ¥
                // ìƒˆë¡œìš´ ì°¨íŠ¸ ìƒì„±
                predictionChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: months, // Xì¶• ë ˆì´ë¸”
                        datasets: [
                            {
                                label: `ì†Œë¹„ ê¸ˆì•¡ (ì›)`, // ë°ì´í„°ì…‹ ì´ë¦„
                                data: data, // ì„ íƒëœ í•­ëª©ì˜ ë°ì´í„°
                                borderColor: '#36a2eb',
                                backgroundColor: 'rgba(54, 162, 235, 0.2)',
                                fill: false // êº¾ì€ì„  ì•„ë˜ ì±„ìš°ê¸°
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: true,
                                position: 'top'
                            }
                        },
                        scales: {
                            x: {
                                title: {
                                    display: true,
                                    text: 'ì›”'
                                }
                            },
                            y: {
                                title: {
                                    display: true,
                                    text: 'ì†Œë¹„ ê¸ˆì•¡ (ì›)'
                                },
                                beginAtZero: true
                            }
                        }
                    }
                });
            }
        
            // ë“œë¡­ë‹¤ìš´ ì„ íƒê°’ì— ë”°ë¼ ì°¨íŠ¸ ì—…ë°ì´íŠ¸
            function updatePredictionChart() {
                const selectedCategory = document.getElementById('categorySelect').value;
                console.log('Selected Category:', selectedCategory);
                const selectedData1 = month1[selectedCategory]; // JSONì—ì„œ ì„ íƒëœ í‚¤ì˜ ê°’ ê°€ì ¸ì˜¤ê¸°
                const selectedData2 = month2[selectedCategory]; // JSONì—ì„œ ì„ íƒëœ í‚¤ì˜ ê°’ ê°€ì ¸ì˜¤ê¸°
                const selectedData3 = month3[selectedCategory]; // JSONì—ì„œ ì„ íƒëœ í‚¤ì˜ ê°’ ê°€ì ¸ì˜¤ê¸°
                const selectedData4 = nextMonthPrediction[selectedCategory];
                const selectedData = [selectedData1,selectedData2,selectedData3,selectedData4];
                renderPredictionChart(selectedData, selectedCategory);
        
                
            }
        
            // ì´ˆê¸°í™”: í˜ì´ì§€ ë¡œë“œ ì‹œ ê¸°ë³¸ ë°ì´í„°ë¡œ ì°¨íŠ¸ ë Œë”ë§
            window.onload = function () {
                document.getElementById('categorySelect').value = 'predicted_total'; // ê¸°ë³¸ê°’ ì„¤ì •
                updatePredictionChart(); // ì°¨íŠ¸ ë Œë”ë§
            };


            function filterData(period) {
                console.log('Selected period:', period); // ì„ íƒëœ ê°’ ì¶œë ¥
                const url = new URL(window.location.href);
                url.searchParams.set('period', period);
                window.location.href = url.toString();
            }


        </script>
        
        <footer>
            <p style="margin: 5px; line-height: 1.2; text-decoration: none; color: #afafb0; font-size: 0.8rem;">ì„œìš¸íŠ¹ë³„ì‹œ ë§ˆí¬êµ¬ ì›”ë“œì»µë¶ë¡œ 434 ìƒì•”ITíƒ€ì›Œ 6ì¸µ</p> 
            <p style="margin: 5px; line-height: 1.2; text-decoration: none; color: #afafb0; font-size: 0.8rem;">ê³ ê°ì§€ì› : 02-3151-7000 | ì´ë©”ì¼: woorifis.lab44@gmail.com </p >
            <p style="margin: 5px; line-height: 1.2; text-decoration: none; color: #afafb0; font-size: 0.8rem;">COPYRIGHTÂ©ìš°ë¦¬ì²œë§Œí•´ìš”</p >
        </footer >
        

        </body>
        </html>
        
